---
import { Icon } from "astro-icon/components";
import type { Project } from "./Project";
import "./project-showcase.css";
import TechPill from "./TechPill.astro";

// --- Define Your Projects Data with REAL image URLs ---
const projects: Project[] = [
  {
    title: "Portfolio Site V3",
    shortDescription: "This portfolio, built with Astro, showcasing interactive components and design.",
    imageUrls: [
      // Replace with actual relevant image URLs from Unsplash etc.
      "https://images.unsplash.com/photo-1517694712202-14dd9538aa97?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80", // Code on screen
      "https://images.unsplash.com/photo-1555949963-ff9fe0c870eb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80", // Laptop showing website
      "https://images.unsplash.com/photo-1587620962725-abab7fe55159?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1031&q=80", // Abstract code lines
    ],
    techStack: ["Astro", "TailwindCSS", "TypeScript", "Vercel"],
    liveUrl: "#", // Link to the live site
    repoUrl: "https://github.com/yourusername/portfolio-v3", // Replace username
    imageLayout: "cover",
  },
  {
    title: "E-Commerce Platform",
    shortDescription: "Full-featured online store with user auth, cart, and checkout.",
    imageUrls: [
      "https://images.unsplash.com/photo-1522204523234-8729aa6e3d5f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80", // People shopping online
      "https://images.unsplash.com/photo-1585194166760-6090e40f094e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80", // UI closeup
      "https://images.unsplash.com/photo-1563013544-824ae1b704d3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80", // Credit card / payment
    ],
    techStack: ["React", "Next.js", "Firebase", "Stripe API", "TailwindCSS"],
    liveUrl: "#",
    repoUrl: "#",
    imageLayout: "cover",
  },
  {
    title: "Data Visualizer",
    shortDescription: "Interactive dashboard displaying complex data using charts.",
    imageUrls: [
      "https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80", // Dashboard screen
      "https://images.unsplash.com/photo-1611162617474-5b21e879e113?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1074&q=80", // Abstract data lines
      "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1115&q=80", // Graph on laptop
    ],
    techStack: ["SvelteKit", "D3.js", "Python", "FastAPI"],
    liveUrl: "#",
    repoUrl: "#",
    imageLayout: "cover",
  },
  // Add more projects...
];

function techNameToSlug(name: string): string {
  return name
    .toLowerCase()
    .replace(/\+/g, "plus") // Replace C++ with cplusplus
    .replace(/[^a-z0-9]/g, ""); // Remove non-alphanumeric chars
}
---

<section id="projects" class="py-20 md:py-28 scroll-mt-20">
  <div class="container mx-auto px-4">
    {/* Section Title */}
    <div class="text-center mb-12 md:mb-16">
      <h2 class="text-4xl md:text-5xl font-bold mb-3 inline-block bg-gradient-to-r from-[oklch(var(--accent-300))] to-[oklch(var(--accent-500))] text-transparent bg-clip-text">
        My <span class="font-doto font-bold">Creations</span>
      </h2>
      <div class="w-24 h-1 bg-gradient-to-r from-[oklch(var(--accent-500))] to-[oklch(var(--accent-900))] mx-auto rounded-full"></div>
      <p class="text-foreground-muted max-w-2xl mx-auto mt-6 text-lg">A selection of projects where code meets creativity.</p>
    </div>

    {/* Projects Grid */}
    <div id="project-grid-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-10">
      {
        projects.map((project, index) => (
          <article class="project-card" data-aos="fade-up" data-aos-delay={index * 100}>
            {/* Slider Viewport */}
            <div class="slider-viewport">
              {/* Scroll Snap Container */}
              <div class="slider-container" data-total-slides={project.imageUrls.length}>
                {project.imageUrls.map((url, slideIndex) => (
                  <div class="slider-slide" data-slide-index={slideIndex}>
                    <img src={url} alt={`${project.title} screenshot ${slideIndex + 1}`} loading="lazy" width="800" height="500" />
                  </div>
                ))}
              </div>

              {/* Enhanced Slider Navigation - Only shown if multiple images */}
              {project.imageUrls.length > 1 && (
                <>
                  <button type="button" aria-label="Previous Slide" class="slider-button prev" data-direction="-1">
                    <Icon name="mdi:chevron-left" />
                  </button>
                  <button type="button" aria-label="Next Slide" class="slider-button next" data-direction="1">
                    <Icon name="mdi:chevron-right" />
                  </button>

                  {/* Pagination Dots */}
                  <div class="slider-pagination">
                    {project.imageUrls.map((_, i) => (
                      <button class={`pagination-dot ${i === 0 ? "active" : ""}`} data-index={i} aria-label={`Go to slide ${i + 1}`} title={`Slide ${i + 1}`} />
                    ))}
                  </div>

                  {/* Slide Counter */}
                  <div class="slide-counter">
                    <span class="current-slide">1</span>
                    <span class="total-slides">/{project.imageUrls.length}</span>
                  </div>
                </>
              )}

              {/* Fullscreen Button */}
              <button type="button" class="fullscreen-button" aria-label="View image fullscreen">
                <Icon name="mdi:fullscreen" />
              </button>
            </div>

            {/* Always Visible Project Info */}
            <div class="project-info">
              <h3 class="project-title">{project.title}</h3>
              <p class="project-description">{project.shortDescription}</p>

              {/* Tech Stack */}
              <div class="project-tech">
                <div class="flex flex-wrap gap-1.5">
                  {project.techStack.map((tech) => (
                    <TechPill name={tech} data-tech={techNameToSlug(tech)} />
                  ))}
                </div>
              </div>

              {/* Action Links */}
              <div class="project-links">
                {project.liveUrl && (
                  <a href={project.liveUrl} target="_blank" rel="noopener noreferrer" class="project-link" title="View live demo">
                    <Icon name="mdi:open-in-new" />
                    <span>View Project</span>
                  </a>
                )}
                {project.repoUrl && (
                  <a href={project.repoUrl} target="_blank" rel="noopener noreferrer" class="project-link" title="View source code">
                    <Icon name="mdi:github" />
                    <span>Source Code</span>
                  </a>
                )}
              </div>
            </div>
          </article>
        ))
      }
    </div>
  </div>
</section>

<script>
  // Define TypeScript interfaces
  interface SliderElements {
    container: HTMLElement;
    dots: NodeListOf<HTMLElement>;
    currentSlideEl: HTMLElement | null;
  }

  interface LightboxElements {
    lightbox: HTMLDivElement;
    closeButton: HTMLButtonElement;
    content: HTMLDivElement;
  }

  // Constants for better maintainability
  const SLIDER_THRESHOLD = 0.1;
  const SWIPE_THRESHOLD = 50;
  const DEBOUNCE_DELAY = 100;

  document.addEventListener("DOMContentLoaded", () => {
    // Cache DOM elements
    const gridContainer = document.getElementById("project-grid-container");
    const cards = Array.from(document.querySelectorAll<HTMLElement>("#project-grid-container .project-card"));
    const sliders = Array.from(document.querySelectorAll<HTMLElement>(".slider-container"));

    // --- Intersection Observer for Card Entrance ---
    const initIntersectionObserver = (): void => {
      if (!cards.length || !("IntersectionObserver" in window)) {
        cards.forEach((card) => card.classList.add("is-visible"));
        return;
      }

      const observerCallback: IntersectionObserverCallback = (entries) => {
        entries.forEach((entry) => {
          entry.target.classList.toggle("is-visible", entry.isIntersecting);
        });
      };

      const observer = new IntersectionObserver(observerCallback, {
        threshold: SLIDER_THRESHOLD,
        rootMargin: "0px 0px -100px 0px",
      });

      cards.forEach((card) => observer.observe(card));
    };

    // --- Slider Navigation System ---
    const handleSliderNavigation = (event: MouseEvent): void => {
      const target = event.target as HTMLElement;
      const button = target.closest<HTMLElement>(".slider-button");
      const paginationDot = target.closest<HTMLElement>(".pagination-dot");
      const fullscreenButton = target.closest<HTMLElement>(".fullscreen-button");

      if (button) {
        const direction = parseInt(button.dataset.direction || "0", 10);
        const sliderContainer = button.closest<HTMLElement>(".project-card")?.querySelector<HTMLElement>(".slider-container");
        if (sliderContainer && direction !== 0) {
          navigateSlider(sliderContainer, direction as 1 | -1);
        }
      } else if (paginationDot) {
        const index = parseInt(paginationDot.dataset.index || "0", 10);
        const sliderContainer = paginationDot.closest<HTMLElement>(".project-card")?.querySelector<HTMLElement>(".slider-container");
        if (sliderContainer) {
          goToSlide(sliderContainer, index);
        }
      } else if (fullscreenButton) {
        const card = fullscreenButton.closest<HTMLElement>(".project-card");
        const currentSlideIndex = getCurrentSlideIndex(card);
        const currentImage = card?.querySelectorAll<HTMLImageElement>(".slider-slide img")[currentSlideIndex];
        currentImage && openLightbox(currentImage);
      }
    };

    // --- Core Slider Functions ---
    const navigateSlider = (container: HTMLElement, direction: -1 | 1): void => {
      const scrollAmount = container.clientWidth * direction;
      const newScrollLeft = container.scrollLeft + scrollAmount;
      const maxScroll = container.scrollWidth - container.clientWidth;

      container.scrollTo({
        left: Math.max(0, Math.min(newScrollLeft, maxScroll)),
        behavior: "smooth",
      });
    };

    const goToSlide = (container: HTMLElement, index: number): void => {
      container.scrollTo({
        left: container.clientWidth * index,
        behavior: "smooth",
      });
    };

    const getCurrentSlideIndex = (card: HTMLElement | null): number => {
      const container = card?.querySelector<HTMLElement>(".slider-container");
      return container ? Math.round(container.scrollLeft / container.clientWidth) : 0;
    };

    // --- Slider Indicators Management ---
    const updateSliderIndicators = (container: HTMLElement, dots: NodeListOf<HTMLElement>, currentSlideEl: HTMLElement | null): void => {
      const activeIndex = Math.round(container.scrollLeft / container.clientWidth);

      dots.forEach((dot, index) => dot.classList.toggle("active", index === activeIndex));
      container.querySelectorAll(".slider-slide").forEach((slide, index) => {
        (slide as HTMLElement).classList.toggle("active", index === activeIndex);
      });

      if (currentSlideEl) {
        currentSlideEl.classList.add("changing");
        requestAnimationFrame(() => {
          currentSlideEl.textContent = `${activeIndex + 1}`;
          requestAnimationFrame(() => currentSlideEl.classList.remove("changing"));
        });
      }
    };

    // --- Lightbox System ---
    const createLightbox = (img: HTMLImageElement): LightboxElements => {
      const lightbox = document.createElement("div");
      lightbox.className = "image-lightbox";

      const content = document.createElement("div");
      content.className = "lightbox-content";

      const closeButton = document.createElement("button");
      closeButton.className = "lightbox-close";
      closeButton.innerHTML = "&times;";
      closeButton.setAttribute("aria-label", "Close fullscreen view");

      content.append(img.cloneNode(), closeButton);
      lightbox.append(content);

      return { lightbox, closeButton, content };
    };

    const openLightbox = (img: HTMLImageElement): void => {
      const { lightbox, closeButton, content } = createLightbox(img);
      document.body.append(lightbox);
      document.body.style.overflow = "hidden";

      const closeLightbox = (): void => {
        lightbox.style.animation = "lightbox-fade-out 0.3s forwards";
        setTimeout(() => {
          lightbox.remove();
          document.body.style.overflow = "";
        }, 300);
      };

      closeButton.addEventListener("click", closeLightbox);
      lightbox.addEventListener("click", (e) => e.target === lightbox && closeLightbox());
      document.addEventListener("keydown", function escHandler(e: KeyboardEvent) {
        if (e.key === "Escape") {
          closeLightbox();
          document.removeEventListener("keydown", escHandler);
        }
      });
    };

    // --- Touch Handling ---
    const handleSwipe = (slider: HTMLElement, startX: number, endX: number): void => {
      const diff = startX - endX;
      if (Math.abs(diff) < SWIPE_THRESHOLD) return;
      navigateSlider(slider, diff > 0 ? 1 : -1);
    };

    // --- Event Listeners Setup ---
    const setupEventListeners = (): void => {
      gridContainer?.addEventListener("click", handleSliderNavigation);

      sliders.forEach((slider) => {
        let touchStartX = 0;

        slider.addEventListener(
          "touchstart",
          (e) => {
            touchStartX = e.touches[0].clientX;
          },
          { passive: true }
        );

        slider.addEventListener(
          "touchend",
          (e) => {
            handleSwipe(slider, touchStartX, e.changedTouches[0].clientX);
          },
          { passive: true }
        );

        const parentCard = slider.closest<HTMLElement>(".project-card");
        const elements: SliderElements = {
          container: slider,
          dots: parentCard?.querySelectorAll(".pagination-dot") || ([] as unknown as NodeListOf<HTMLElement>),
          currentSlideEl: parentCard?.querySelector(".current-slide") ?? null,
        };

        let scrollTimeout: number;
        slider.addEventListener("scroll", () => {
          window.clearTimeout(scrollTimeout);
          scrollTimeout = window.setTimeout(() => {
            updateSliderIndicators(elements.container, elements.dots, elements.currentSlideEl);
          }, DEBOUNCE_DELAY);
        });
      });

      document.addEventListener("keydown", (e) => {
        const focusedCard = document.activeElement?.closest<HTMLElement>(".project-card");
        const sliderContainer = focusedCard?.querySelector<HTMLElement>(".slider-container");
        if (!sliderContainer) return;

        if (e.key === "ArrowLeft") navigateSlider(sliderContainer, -1);
        if (e.key === "ArrowRight") navigateSlider(sliderContainer, 1);
      });
    };

    // --- Initialization ---
    initIntersectionObserver();
    setupEventListeners();
    addLightboxStyles();

    // --- Style Injection (Singleton) ---
    function addLightboxStyles(): void {
      if (document.querySelector("#lightbox-styles")) return;

      const style = document.createElement("style");
      style.textContent = `
      .image-lightbox {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        cursor: pointer;
      }
      .lightbox-content {
        position: relative;
        max-width: 90%;
        max-height: 90%;
      }
      .lightbox-content img {
        max-width: 100%;
        max-height: 90vh;
        object-fit: contain;
      }
      .lightbox-close {
        position: absolute;
        top: -2rem;
        right: -2rem;
        background: transparent;
        border: none;
        color: white;
        font-size: 2rem;
        cursor: pointer;
      }
    `;
      document.head.append(style);
    }
  });
</script>

<style>
  /* Base Card Styles with improved transitions */
  .project-card {
    display: flex;
    flex-direction: column;
    background-color: color-mix(in oklch, rgb(var(--background)), white 3%);
    border-radius: 0.75rem;
    box-shadow:
      0 4px 6px -1px rgb(0 0 0 / 0.1),
      0 2px 4px -2px rgb(0 0 0 / 0.1);
    overflow: hidden;
    transition:
      transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
      box-shadow 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
      background-color 0.3s ease-out;
    height: 100%;
    will-change: transform, box-shadow;
  }

  /* Enhanced hover effect with glow and better spring physics */
  .project-card:hover,
  .project-card:focus-within {
    box-shadow:
      0 15px 30px -5px oklch(var(--accent-500) / 0.2),
      0 8px 15px -6px oklch(var(--accent-500) / 0.15);
    transform: translateY(-8px) scale(1.01);
    background-color: color-mix(in oklch, rgb(var(--background)), white 5%);
  }

  /* Touch device support with active state animation */
  @media (hover: none) {
    .project-card:active {
      transform: translateY(-4px) scale(0.98);
      box-shadow:
        0 8px 15px -5px oklch(var(--accent-500) / 0.2),
        0 4px 10px -6px oklch(var(--accent-500) / 0.15);
      transition: all 0.2s ease-out;
    }
  }

  /* Improved Slider Styles with better transitions */
  .slider-viewport {
    position: relative;
    overflow: hidden;
    aspect-ratio: 16 / 10;
    border-radius: 0.75rem 0.75rem 0 0;
  }

  .slider-container {
    overflow-x: scroll;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    display: flex;
    height: 100%;
    scrollbar-width: none;
    -ms-overflow-style: none;
    position: relative;
    touch-action: pan-x;
  }

  .slider-container::-webkit-scrollbar {
    display: none;
  }

  .slider-slide {
    flex-shrink: 0;
    width: 100%;
    height: 100%;
    scroll-snap-align: center;
    position: relative;
    transition: transform 0.3s ease-out;
    overflow: hidden;
  }

  /* Add subtle zoom animation on slide change */
  .slider-slide.active img {
    animation: subtle-zoom 5s ease-out forwards;
  }

  @keyframes subtle-zoom {
    from {
      transform: scale(1);
    }
    to {
      transform: scale(1.05);
    }
  }

  .slider-slide img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition:
      transform 0.7s ease-out,
      filter 0.3s ease-out;
  }

  /* Subtle image enhancement on hover */
  .project-card:hover .slider-slide img {
    filter: brightness(1.05) contrast(1.05);
  }

  /* Enhanced slider control transitions */
  .slider-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%) scale(0.9);
    z-index: 10;
    background-color: rgba(0, 0, 0, 0.5);
    color: white;
    border: none;
    border-radius: 50%;
    width: 2.5rem;
    height: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition:
      opacity 0.3s ease-out,
      transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
      background-color 0.2s ease-out;
    opacity: 0.7;
    backdrop-filter: blur(4px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }

  @media (min-width: 768px) {
    .slider-button {
      opacity: 0;
      transform: translateY(-50%) scale(0.8);
    }

    .slider-viewport:hover .slider-button,
    .slider-viewport:focus-within .slider-button {
      opacity: 0.7;
      transform: translateY(-50%) scale(0.9);
    }
  }

  .slider-button:hover {
    background-color: rgba(0, 0, 0, 0.8);
    opacity: 1;
    transform: translateY(-50%) scale(1);
  }

  .slider-button:active {
    transform: translateY(-50%) scale(0.9);
    transition: transform 0.1s ease-out;
  }

  .slider-button.prev {
    left: 0.75rem;
  }

  .slider-button.next {
    right: 0.75rem;
  }

  .slider-button svg {
    width: 1.5rem;
    height: 1.5rem;
    transition: transform 0.2s ease-out;
  }

  /* Button icon animation on hover */
  .slider-button.prev:hover svg {
    transform: translateX(-2px);
  }

  .slider-button.next:hover svg {
    transform: translateX(2px);
  }

  /* Improved pagination dots with better animations */
  .slider-pagination {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    display: flex;
    gap: 0.5rem;
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    background-color: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(4px);
    transition:
      opacity 0.3s ease-out,
      transform 0.3s ease-out;
    transform-origin: center bottom;
  }

  @media (min-width: 768px) {
    .slider-pagination {
      opacity: 0;
      transform: translateX(-50%) translateY(10px) scale(0.9);
    }

    .slider-viewport:hover .slider-pagination,
    .slider-viewport:focus-within .slider-pagination {
      opacity: 1;
      transform: translateX(-50%) translateY(0) scale(1);
    }
  }

  .pagination-dot {
    width: 0.5rem;
    height: 0.5rem;
    border: none;
    border-radius: 50%;
    padding: 0;
    background-color: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition:
      transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
      background-color 0.3s ease-out;
  }

  .pagination-dot:hover {
    background-color: rgba(255, 255, 255, 0.8);
    transform: scale(1.2);
  }

  .pagination-dot.active {
    background-color: white;
    transform: scale(1.3);
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
  }

  /* Slide counter with improved animation */
  .slide-counter {
    position: absolute;
    bottom: 1rem;
    right: 1rem;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 0.25rem 0.5rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    backdrop-filter: blur(4px);
    z-index: 10;
    transition:
      opacity 0.3s ease-out,
      transform 0.3s ease-out;
    transform-origin: center right;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
  }

  @media (min-width: 768px) {
    .slide-counter {
      opacity: 0;
      transform: translateX(10px) scale(0.9);
    }

    .slider-viewport:hover .slide-counter,
    .slider-viewport:focus-within .slide-counter {
      opacity: 1;
      transform: translateX(0) scale(1);
    }
  }

  .current-slide {
    font-weight: 600;
    display: inline-block;
    min-width: 0.8rem;
    text-align: center;
  }

  /* Slide counter number change animation */
  .current-slide.changing {
    animation: counter-change 0.3s ease-out;
  }

  @keyframes counter-change {
    0% {
      transform: translateY(0);
      opacity: 1;
    }
    50% {
      transform: translateY(-5px);
      opacity: 0;
    }
    51% {
      transform: translateY(5px);
      opacity: 0;
    }
    100% {
      transform: translateY(0);
      opacity: 1;
    }
  }

  .total-slides {
    opacity: 0.8;
  }

  /* Fullscreen button with improved animation */
  .fullscreen-button {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background-color: rgba(0, 0, 0, 0.5);
    color: white;
    border: none;
    border-radius: 50%;
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10;
    transition:
      opacity 0.3s ease-out,
      transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
      background-color 0.2s ease-out;
    opacity: 0;
    transform: scale(0.8);
    backdrop-filter: blur(4px);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
  }

  .slider-viewport:hover .fullscreen-button,
  .slider-viewport:focus-within .fullscreen-button {
    opacity: 0.7;
    transform: scale(1);
  }

  .fullscreen-button:hover {
    background-color: rgba(0, 0, 0, 0.8);
    opacity: 1;
    transform: scale(1.1);
  }

  .fullscreen-button:active {
    transform: scale(0.95);
  }

  .fullscreen-button svg {
    width: 1.25rem;
    height: 1.25rem;
    transition: transform 0.2s ease-out;
  }

  .fullscreen-button:hover svg {
    transform: scale(1.1);
  }

  /* Always visible project info section with better transitions */
  .project-info {
    padding: 1.25rem;
    background-color: color-mix(in oklch, rgb(var(--background)), white 1%);
    border-top: 1px solid rgba(var(--foreground), 0.08);
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    position: relative;
    opacity: 1;
    transform: none;
    transition:
      padding 0.3s ease-out,
      background-color 0.3s ease-out;
    flex: 1;
    min-height: 0;
  }

  .project-card:hover .project-info {
    background-color: color-mix(in oklch, rgb(var(--background)), white 4%);
  }

  .project-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: rgb(var(--foreground));
    margin: 0;
    line-height: 1.3;
    transition:
      transform 0.3s ease-out,
      color 0.3s ease-out;
  }

  .project-card:hover .project-title {
    color: oklch(var(--accent-500));
    transform: translateX(2px);
  }

  .project-description {
    font-size: 0.875rem;
    line-height: 1.5;
    color: rgb(var(--foreground-muted));
    margin: 0;
    flex-grow: 1;
    transition: opacity 0.3s ease-out;
  }

  .project-card:hover .project-description {
    opacity: 0.9;
  }

  .project-tech {
    margin-top: 0.25rem;
    transition: transform 0.3s ease-out;
  }

  .project-card:hover .project-tech {
    transform: translateY(-2px);
  }

  /* Tech pills animation on card hover */
  .project-tech [data-tech] {
    transition:
      transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
      opacity 0.3s ease-out;
  }

  .project-card:hover .project-tech [data-tech] {
    opacity: 1;
  }

  /* Stagger tech pills animation */
  .project-card:hover .project-tech [data-tech]:nth-child(1) {
    transition-delay: 0s;
  }
  .project-card:hover .project-tech [data-tech]:nth-child(2) {
    transition-delay: 0.05s;
  }
  .project-card:hover .project-tech [data-tech]:nth-child(3) {
    transition-delay: 0.1s;
  }
  .project-card:hover .project-tech [data-tech]:nth-child(4) {
    transition-delay: 0.15s;
  }
  .project-card:hover .project-tech [data-tech]:nth-child(5) {
    transition-delay: 0.2s;
  }
  .project-card:hover .project-tech [data-tech]:nth-child(6) {
    transition-delay: 0.25s;
  }

  .project-links {
    display: flex;
    justify-content: space-between;
    margin-top: 0.5rem;
    flex-wrap: wrap;
    border-top: 1px solid rgba(var(--foreground), 0.08);
    padding-top: 0.75rem;
    width: 100%;
    transition: transform 0.3s ease-out;
  }

  .project-card:hover .project-links {
    transform: translateY(-2px);
  }

  .project-link {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.375rem 0.75rem;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    background-color: rgba(var(--foreground), 0.05);
    color: oklch(var(--accent-500));
    transition:
      all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
      box-shadow 0.3s ease-out;
    font-weight: 500;
    min-width: calc(50% - 0.5rem);
    justify-content: center;
    position: relative;
    overflow: hidden;
    box-shadow: 0 0 0 rgba(var(--accent-500), 0);
  }

  .project-link:hover {
    background-color: oklch(var(--accent-500) / 0.1);
    color: oklch(var(--accent-500));
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 3px 10px -2px oklch(var(--accent-500) / 0.2);
  }

  /* Button press effect */
  .project-link:active {
    transform: translateY(-1px) scale(0.98);
    transition: all 0.1s ease-out;
  }

  /* Button shine effect on hover */
  .project-link::before {
    content: "";
    position: absolute;
    top: -50%;
    left: -60%;
    width: 20%;
    height: 200%;
    background: rgba(255, 255, 255, 0.2);
    transform: rotate(30deg);
    transition: all 0.6s;
    opacity: 0;
  }

  .project-link:hover::before {
    left: 120%;
    opacity: 0.3;
  }

  .project-link svg {
    width: 1rem;
    height: 1rem;
    transition: transform 0.3s ease-out;
  }

  .project-link:hover svg {
    transform: scale(1.2);
  }

  /* Improved card entrance animations */
  .project-card {
    opacity: 0;
    transform: translateY(40px);
    transition:
      opacity 0.8s cubic-bezier(0.22, 1, 0.36, 1),
      transform 0.8s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .project-card.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .slider-button {
      width: 2rem;
      height: 2rem;
      opacity: 0.85; /* More visible on mobile */
      transform: translateY(-50%) scale(1);
    }

    .slider-button svg {
      width: 1.25rem;
      height: 1.25rem;
    }

    .project-info {
      padding: 1rem;
    }

    /* Always show controls on mobile */
    .slider-pagination,
    .slide-counter {
      opacity: 1;
      transform: translateX(-50%) scale(1);
    }

    .slide-counter {
      transform: translateX(0) scale(1);
    }
  }

  /* Improved lightbox animations */
  .image-lightbox {
    animation: lightbox-fade-in 0.3s ease-out forwards;
  }

  @keyframes lightbox-fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  .lightbox-content img {
    animation: lightbox-zoom-in 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
  }

  @keyframes lightbox-zoom-in {
    from {
      transform: scale(0.9);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }
</style>
